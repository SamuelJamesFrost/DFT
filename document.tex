\documentclass[10pt,a4paper,twocolumn,twoside]{extarticle}

\title{Dispersion Corrections in Density Field Theory}
\author{Samuel James Frost}
\def\ID{20184093}
\input{header.tex}

\usepackage[style=ieee,citestyle=ieee]{biblatex}
\addbibresource{references.bib}
\usepackage[font=small]{caption}
\usepackage{lipsum}

\newcommand{\al}{\emph{et al. }}

\begin{document}
	\thispagestyle{empty}
	\twocolumn[
	\begin{@twocolumnfalse}
		\begin{center}
			\vspace*{-10mm}
			{\Large\scshape\papertitle}\\
			\vspace{2ex}
			{\itshape\paperauthor}
		\end{center}
		\centering\noindent\rule{0.9\textwidth}{0.4pt}
		\begin{abstract}
			{\lipsum[5]}
		\end{abstract}
		\centering\noindent\rule{0.9\textwidth}{0.4pt}\\
		\vspace{1cm}
	\end{@twocolumnfalse}]
	\pagenumbering{arabic}
	\tableofcontents

	
	\section{Introduction}
	Covalent and ionic bonds are normally considered the most important interactions in terms of making a molecule, but the lesser known dispersion interaction (often known as Van der Waals interactions, or London Dispersion forces) plays just as an important role, if not more so in some highly important molecules like DNA.

	But what are dispersion interactions? Fluctuations of electron density, both inside of molecules and between separate ones, cause atoms to have a lopsided charge (positive on one end, negative on the other), making them polar. This can have a knock on effect, causing other atoms to become polar. This is always a long range attractive force, and so balances out always repulsive forces, such as the strong force.

	Primitive DFT methods neglected these interactions, causing DNA to unwind and graphene sheets to repel each other. Whilst this wasn't as much a problem in basic solid state physics, where unit cells are only made up of purely covalent or ionic bonds, it affects all areas of science where complicated molecules are involved. 
	Many diverse solutions were developed, and are still being developed, to overcome this problem. They include methods which are fit to empirical data, like Grimme's DFT-D2 and DFT-D3, which are generally faster. And pure methods, such as VV10 and vdw-DFT, which are (slightly) more costly.

	The total electronic ground state energy of an atom, molecule, or ion, can be written as follows
	\begin{align}
		E_\text{tot} &= E_T + E_V + E_J + E_X + E_C
	\end{align}
	$E_T$ is the total kinetic energy of the electrons, and is always positive, $E_V$ is the total potential energy due to the attraction of the electron to the positive nuclear centre(s), this is also always negative. $E_J$ is the \emph{average} energy of the Coloumb repulsion between pairs of electrons, and is always positive, this doesn't paint the full picture however. 
	It does not take into account the instantaneous influence of electrons on one another when they are in close proximity. Electrons will always try to repel each other, they will avoid each other, therefore the movements of one electron depends on the others, they are \emph{correlated}, this lowers the energy of the system as it reduces the repulsion between electrons. $E_J$ does not take this into account as it is only modelled as the electrons moving in the average potential field of all the other electrons, and therefore does not include induvidual correlation effects. 
	To fix this the negative $E_X$ and $E_C$ correction terms are introduced, and are often lumped together into a single term dubbed the exchange correlation energy $E_{XC}$. 
	$E_X$, the exchange energy, accounts for the much stronger correlated moton of electron sharing the same spin, caused by the Pauli exclusion principle, and removes the non-physical self repulsion terms included in $E_J$. $E_C$, the correlation energy, is much smaller and accounts for the weaker correlated motion of electrons with opposite spin. 
	The calculation of the exchange correlation energy is a formidable task however....
	It is the exchange correlation energy which represents van der Waals interactions in the system, and so is the goal of the dispersion corrections mentioned in this paper.


	


	\section{Semi-emperical Corrections}
	\subsection{Semi-local Density Functional Theory}
	
	\subsection{DFT-D2}
	\subsubsection{Theory}
	In 2006 Stefan Grimme published DFT-D2\cite{Grimme2006}, 
	the successor to his more limited DFT-D method. The main setback of this original method was the narrow scope of the atoms as it could model, only Hydrogen and Carbon through to Neon. This, paired with very large inconsistencies for thermochemical calculations (e.g. energy of atomisation) made it a very limited method in dire need of improvement for it to become widespread.

	The basis of the DFT-D2 dispersion correction is in the pairwise attraction between distinct atoms $i$ and atoms $j$ for all $N$ atoms in the system. \cite{Grimme2006}
	\begin{align} \label{eq:D2}
	E_{\rm disp} \defeq -s_6 \sum^{N-1}_{i=1} \sum^N_{j=i+1} \frac{C^{i,j}_{6}}{R^6_{i,j}} f_{\rm damp}(R_{i,j})
	\end{align} 
	\noindent
	Where $C_6^{i,j}$ is the dispersion coefficient for the pair of atoms $i$ and $j$, $s_6$ is the scaling factor depending on the functional used, and $R_{i,j}$ is the interatomic separation. 
	$C_6^{i,j}$ is calculated by the taking the geometric mean of the single atoms 
	\begin{align} \label{eq:C6ij}
		C_6^{i,j} = \sqrt{C_6^i C_6^j}
	\end{align}
	These atomic $C_6$ values are themselves computed through the PBE0 functional\cite{Grimme2011}. They are the same irrespective of the chemical environment, $C_6$ for carbon in methane is the same as in benzene, when obviously the dispersion interactions differ, this glaring hole is fixed in DFT-D3, where the chemical environment is considered.
	\begin{align} \label{eq:C6i}
		C_6^i = 0.05NI_i \alpha_i
	\end{align}
	$N$ is a scaling factor which depends on the row of the periodic table, taking on the value of the atomic mass of the element at the end of the row (e.g. for row 4 $N = 36$). $I$ is the first ionisation potential and $\alpha$ the static dipole polarisability, both of which are found with the PBE$0$ functional. These atomic dispersion coefficients are only available up to Xenon, a large improvement on DFT-D.

	$f_{\rm damp}(R_{i,j})$, which can be seen in figure: \ref{fig:Fermi}, is a Fermi damping function which ensures that the dispersion correction goes to zero as $R_{i,j}$ decreases. Without this damping function the $1/R_{i,j}^6$ term would grow too large as $R_{i,j} \rightarrow 0$, causing a singularity to form. This would in turn cause van der Waals interactions to be dwarf other forces, making molecules effectively stick together and never come apart.

	\begin{align} \label{eq:damp}
		f_{\rm damp}(R_{i,j}) \defeq \frac{1}{1+\exp(-d(R_{i,j}/R_r -1))}
	\end{align}
	\begin{figure}
		\begin{tikzpicture}
		  \begin{axis}[
			width=200pt,
			xlabel = \(R_{i,j}\),
			ylabel = {\(f_\text{damp}(R_{i,j})\)},
			]
			\addplot[
			  color=blue,
			  domain=0:2,
			  samples=50,
			  width=5pt,
			  ]
			  {1/(1+exp(-10*x+10))};
			\end{axis}
		\end{tikzpicture}
		\caption{The Fermi damping function which ensures that the van der Waals correction energy doesn't grow too large as $R_{i,j} \rightarrow 0$}
		\label{fig:Fermi}
	\end{figure}
	Here, $R_r$ is the sum of the atomic van der Waals radii of the two atoms, which is derived from Restricted Open-shell Hartree-Fock calculations, in DFT-D2 $d = 20$, a small value compared to DFT-D, giving stronger corrections at intermediate distances. 

	The scaling paramater $s_6$ and the constant Fermi damping function constant $d$ are both reliant on the functional used. They can both be changed however to fit different environment types if necessary, \emph{e.g.} one may use a different $s_6$ value for the adsorption to silver\cite{Schiavo2018} than one may use for modelling noble gasses.  
	These values are fit to emperical data however (hence the section name), leading critics to argue that this method is essentially just changing parameters until the data aligns with the accepted values.

	This dispersion correction, $E_{\rm disp}$, is simply added on to the Kohn-Sham energy obtained from the chosen functional.

	\emph{Maybe talk about empiricism more}
	\subsubsection{Application}

	One area where DFT-D2 fails is under extreme conditions, Ilawe \emph{et al.} found that DFT-D2 beings to break down for Palladium Hydrides under large amounts of stress, giving errors close to 40\% when compared with experimental data.\cite{Ilawe2015} This, coupled with its general poor performance when heavy metals surfaces are involved make for some very poor results.\emph{REFERENCE THIS}
	Researching how different computational methods model the adsorption of noble gasses to heavy metals, Chen found that DFT-D2 vastly overestimates the energy of adsorption by a factor of two, leading to the conclusion that "the DFT-D2 method, at least with recommended parameterisation, is not suitable for investigating noble gas adsorption on metals".\cite{Chen2012} 
	In a limited study involving a Ag (1 1 1) surface and aromatic molecules, Schiavo \al attempted to reparamataise DFT-D2 to better suit adsorption to metal surfaces. Fitting $R_r$ against MP2 data, causing an increase in $R_r$, was found to limit overbinding whilst still semi-accurately describing the geometry.\cite{Schiavo2018} This method could be applied to other metal surfaces and adsorbants in the future. 

	Kim \emph{et al.} compared the results of the equilibrium spacing for sheets of black phosphorus with and without multiple dispersion corrections applied. For PBE with no correction there was a 10\% difference compared with experimental data, however with DFT-D2 applied that dropped down to only 0.5\%, obviously a very successful result for DFT-D2.\cite{Kim2014} 

	\subsection{DFT-D3}
	\subsubsection{Theory}
	As mentioned earlier, DFT-D2 does not consider the chemical environment of the atom. Covalent bonds change the electronic structure, half occupied atomic orbitals become lower energy molecular orbitals. This lowers the polarisability of the atom, meaning a smaller $C_6$ constant is needed. DFT-D3 considers the coordination number of the atom, giving a more accurate result. \cite{Grimme2010} D3 also uses higher order correction terms (which correspond to a higher order distance factor too), however these generally stop at $C_8$, as any higher has shown to give unstable results for larger molecules.

	The coordination number for an atom $A$ in a molecule with $N$ atoms is given by 
	{\small
	\begin{align}
		{\rm CN}^A = \sum_{B \neq A}^N \frac{1}{1 + e^{-16(4(R_A,{\rm cov} + R_A,{\rm cov})/(3R_{AB}) - 1)}}
	\end{align}}
	where $R_A,{\rm cov}$ is the covalent radius and $R_{AB}$ the distance between the two atoms.

	For the dispersion coefficient of a specific system the electric dipole polarisability $\alpha^A (i\omega)$ is calculated for the free atom as well as differently coordinated hydrides, $A_mH_n$ and $B_kH_l$ using the PBE38 hybrid functional.\cite{Grimme2011} An altered Casimir-Polder expression is used to find the new dispersion coefficient. 

	\begin{align}
		C_6^{AB} ({\rm CN}^A , {\rm CN}^B) =  \nonumber \\ \frac{3}{\pi} \int^{\infty}_0 \frac{1}{m} \left(\alpha^{A_m H_n}(i\omega) - \frac{n}{2} \alpha^{H_2} (i\omega) \right) \nonumber \\ \cross \frac{1}{k} \left(\alpha^{B_k H_l}(i\omega) - \frac{l}{2} \alpha^{H_2} (i\omega)\right) d\omega 
	\end{align}
	Here the $A_mH_n$ reference compound corresponds to the required coordination number of the atom $A$, the contribution of the hydrogen atoms to the polarisability is then subtracted from this. 
	
	These $C_6$ values are precomputed for every possible coordination number and atom pair. In the actual calculation the dispersion coefficient is evaluated as the Gaussian average of the previous values. This means that only the geometry of a molecule is required to calculate its dispersion coefficent. From here we can calculate the higher order $C_8$ dispersion coefficent.
	\begin{align}
		C_8^{AB} &= 3C_6^{AB} \sqrt{Q_A Q_B}\\
		Q_A  &= \sqrt{Z_A} \frac{\langle r_A^4 \rangle}{\langle r_A^2 \rangle}
	\end{align}
	Where $\langle r_A^4 \rangle$ and $\langle r_A^2 \rangle$ are multipole-type expectation values and $Z_A$ is the atomic number of atom $A$. $C_8$ is the highest order dispersion coefficient calculated however, $C_{10}$ is ignored and instead absorbed into the $s_8$ scaling factor.

	\subsubsection{Application}
	 GGA functionals such as PBE tend to underestimate the cohesive energy of a chemical. Boungou \al calculated the cohesive energy of silver using the PBE functional and compared it with the D3 correction applied, finding errors of 12\% and 1\% respectively.\cite{Boungou2021} 
	 Kovacs \al ran some comparisons of different functionals paired with dispersion corrections on noble gasses, a common benchmark for dispersion corrections. For the neon dimer, BLYP-D3 was 5\% (absolute) more accurate than BLYP-D2, and for the interaction energy, was 50\% (also absolute) more accurate.\cite{Kovacs2017} 
	 This is clearly a great improvement over the previous method, and for interactions where simple van der Waals interactions are concerned, shows how robust the updated method is. However, careful consideration for the correct functional should be had, as more basic functionals, such as PBE, returned values twice as large as the experimental data.\cite{Kovacs2017}

	 FIND DISAGREEING EVIDENCE 



	\section{Pure Methods}
	\subsection*{notes}
	VV09 and VV10 - vydrov, vdW-DFT
	\subsection*{actual}
	Unlike the semi-classical methods to find the electron correlation energy, such as  DFT-D2 and DFT-D3 (see sections 2.1 and 2.2 respectively) which use forces whose properties are derived from emperical data, the non-local correlation methods discussed in this section require only the electron density. Their lack of reliance on emperical data lead many to believe these methods to be more "pure" in a mathematical sense, hence the name of the section. These types of methods find a balance between the overly rigorous (and therefore slow) random-phase approximation methods, and the less accurate semi-classical methods. 

	These methods are non-local, they compare the electron density at \emph{every point in space}, compared to regular DFT, where the functional depends only on one \emph{local} position in space. 
	The range of points which are used is very important, as to include both short-medium range forces and long range forces, both of which affect the system.


	The non-local correlation energy (in natural units) is defined as 
	\begin{align}
		E = \frac{1}{2}\int \int dr dr' \rho(r) \Phi(r, r') \rho(r')
	\end{align}
	where $\Phi(r, r')$ is the \emph{correlation kernel} (a functional to be integrated), and $\rho(r)$ is the electron density at point $r$.
	This finds the same energy as the semi-emperical approaches, but includes every point in space. This integral is used for every vdw-DFT based (pure) method, and so does not need repeating. 

	Fluctuating electron density? Unlike DFT which keeps it constant? Dunno, this is too hard
	Talk about density fluctuations and how that creates an attractive force

	\subsection{VV10}
	\subsubsection*{Notes}
	Easy to implement, computationally efficient undemanding in terms of the basis set quality or
	the fineness of the numerical integration grid. vdw-DF2 seems to underbind -- vydrov2012
	\subsubsection{Theory}
	VV10 is the simplest dispersion correction in the VV family. 

	The correlation kernel is introduced to be 
	\begin{align}
		\Phi = - \frac{3}{2gg'(g+g')}
	\end{align}
	where 
	\begin{align}
		g &= \omega_0(r)R^2 + \kappa(r)\\
		R &= \absolutevalue{r - r'}.
	\end{align}
	
	$\omega_0(r)$ above is 

	\begin{align}
		\omega_0(r) = \sqrt{ \omega_g^2(r) + \frac{\omega_p^2(r)}{3}} 
	\end{align}
	where $\omega_p$ is the local plasma frequency and is defined as 
	\begin{align}
		\omega_p^2(r) &= 4\pi \rho
	\end{align}
	where $\rho$ is the \emph{total} electron density. The local band gap $\omega_g^2(r)$ is 
	\begin{align}
		\omega_g^2(r) = C \absolutevalue{\frac{\grad \rho(r)}{\rho(r)}}^4
	\end{align}
	where C is a paramater to be adjusted. The last part of $g$ is 
	\begin{align}
		\kappa(r) &= b \frac{\nu_F^2(r)}{\omega_p(r)} \\
		\nu_F(r) &= (3 \pi^2 \rho)^{1/3}
	\end{align}
	where b is another adjustable parameter.
	Despite the large amount of equations here, it's important to note that everything here relies on only two things, the electron density, $\rho(r)$, at a certain point $r$, and the \emph{total} electron density.  


	
	\newpage
	\printbibliography

\end{document}

